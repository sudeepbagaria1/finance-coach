<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Elev8r – Budget Sheet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-slate-100 p-4">
  <div class="max-w-4xl mx-auto bg-white p-6 rounded shadow">
    <h1 class="text-2xl mb-4">My Budget Sheet</h1>

    <div x-data="sheet()" x-init="load()">
      <!-- Income row -->
      <div class="grid grid-cols-4 gap-2 mb-2 font-semibold">
        <div>Category</div><div>Your ₹</div><div>India Avg %</div><div>India Avg ₹</div>
      </div>

      <!-- Needs rows -->
      <template x-for="(row, key) in needs" :key="key">
        <div class="grid grid-cols-4 gap-2 mb-1">
          <div x-text="row.label"></div>
          <input type="number" x-model.number="row.value" @input="recalc()"
                 class="w-full border px-1 rounded">
          <div x-text="row.avgPct + '%'"></div>
          <div x-text="row.avgRs.toLocaleString()"></div>
        </div>
      </template>

      <!-- Totals -->
      <div class="grid grid-cols-4 gap-2 mt-4 font-bold">
        <div>Total Needs (50 %)</div>
        <div>₹ <span x-text="needsTotal.toLocaleString()"></span></div>
        <div>50 %</div>
        <div>₹ <span x-text="needsTarget.toLocaleString()"></span></div>
      </div>

      <div class="grid grid-cols-4 gap-2">
        <div>Savings (20 %)</div>
        <div>₹ <span x-text="savings.toLocaleString()"></span></div>
        <div>20 %</div>
        <div>₹ <span x-text="savingsTarget.toLocaleString()"></span></div>
      </div>

      <div class="grid grid-cols-4 gap-2">
        <div>Wants (30 %)</div>
        <div>₹ <span x-text="wants.toLocaleString()"></span></div>
        <div>30 %</div>
        <div>₹ <span x-text="wantsTarget.toLocaleString()"></span></div>
      </div>

      <button @click="save()" class="mt-6 bg-green-600 text-white px-4 py-2 rounded">Save</button>
      <button @click="location.href='goal-board.html'" class="ml-2 bg-blue-600 text-white px-4 py-2 rounded">Goals →</button>
    </div>
  </div>

  <script>
  function sheet() {
    return {
      income: 0,
      needsTotal: 0,
      needsTarget: 0,
      savings: 0,
      savingsTarget: 0,
      wants: 0,
      wantsTarget: 0,
      needs: {
        kitchen:   {label:'Kitchen',   value:0, avgPct:32.5}, // 30–35 %
        school:    {label:'School',    value:0, avgPct:7.5},  // 5–10 %
        medicine:  {label:'Medicine',  value:0, avgPct:6.5},  // 5–8 %
        rent:      {label:'Rent/EMI',  value:0, avgPct:22.5}, // 20–25 %
        transport: {label:'Transport', value:0, avgPct:10},   // 8–12 %
        others:    {label:'Others',    value:0, avgPct:15}    // 10–20 %
      },
      load() {
        const user = JSON.parse(localStorage.getItem('elev8r_user') || '{}');
        this.income = +user.income || 0;
        this.recalc();
      },
      recalc() {
        // compute target rupees based on percentages
        this.needsTarget   = Math.round(this.income * 0.50);
        this.savingsTarget = Math.round(this.income * 0.20);
        this.wantsTarget   = Math.round(this.income * 0.30);

        // populate India-average rupees
        for (const key in this.needs) {
          this.needs[key].avgRs = Math.round(this.income * (this.needs[key].avgPct / 100));
        }

        // user totals
        this.needsTotal = Object.values(this.needs).reduce((s, r) => s + r.value, 0);
        this.savings   = this.savingsTarget;
        this.wants     = this.wantsTarget;
      },
      save() {
        const data = JSON.parse(localStorage.getItem('elev8r_user') || {});
        data.needs = Object.fromEntries(Object.entries(this.needs).map(([k,v])=>[k,v.value]));
        localStorage.setItem('elev8r_user', JSON.stringify(data));
        alert('Saved!');
      }
    };
  }
  </script>
</body>
</html>