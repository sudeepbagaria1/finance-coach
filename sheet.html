<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Elev8r – Budget Sheet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="bg-slate-100 p-4">
  <div class="max-w-4xl mx-auto bg-white p-6 rounded shadow">
    <h1 class="text-2xl mb-4">My Budget Sheet</h1>

    <div x-data="sheet()" x-init="load()">
      <!-- Income row -->
      <div class="grid grid-cols-3 gap-4 mb-2">
        <div>Monthly Income</div>
        <div>₹ <span x-text="income"></span></div>
        <div></div>
      </div>

      <!-- Needs (editable) -->
      <template x-for="(row, key) in needs" :key="key">
        <div class="grid grid-cols-3 gap-4 mb-1">
          <div x-text="row.label"></div>
          <input type="number" x-model.number="row.value" @input="recalc()"
                 class="w-full border px-1 rounded">
          <span class="text-xs" :class="row.delta<0 ? 'text-green-600':'text-red-600'">
            vs India: <span x-text="row.delta.toFixed(1)+'%'"></span>
          </span>
        </div>
      </template>

      <!-- Savings & Wants -->
      <div class="grid grid-cols-3 gap-4 mt-4">
        <div>Savings (20 %)</div>
        <div>₹ <span x-text="savings"></span></div>
        <div></div>
        <div>Wants (30 %)</div>
        <div>₹ <span x-text="wants"></span></div>
        <div></div>
      </div>

      <button @click="save()" class="mt-6 bg-green-600 text-white px-4 py-2 rounded">Save</button>
      <button @click="location.href='goal-board.html'" class="ml-2 bg-blue-600 text-white px-4 py-2 rounded">Goals →</button>
    </div>
  </div>

  <script>
  function sheet() {
    return {
      income: 0,
      needs: {
        kitchen:{label:'Kitchen', value:0, delta:0},
        school:{label:'School', value:0, delta:0},
        medicine:{label:'Medicine', value:0, delta:0},
        rent:{label:'Rent', value:0, delta:0},
        transport:{label:'Transport', value:0, delta:0},
        others:{label:'Others', value:0, delta:0}
      },
      savings:0, wants:0,
      benchmarks:{ kitchen:4500, school:3000, medicine:800, rent:7000, transport:2000, others:2000 },
      load() {
        const user = JSON.parse(localStorage.getItem('elev8r_user') || '{}');
        this.income = +user.income || 0;
        this.recalc();
      },
      recalc() {
        const totalNeeds = Object.values(this.needs).reduce((s, r) => s + r.value, 0);
        this.savings = Math.round(this.income * 0.20);
        this.wants  = Math.round(this.income * 0.30);
        for (const key in this.needs) {
          const avg = this.benchmarks[key] || 0;
          this.needs[key].delta = ((this.needs[key].value - avg) / avg) * 100;
        }
      },
      save() {
        const data = JSON.parse(localStorage.getItem('elev8r_user') || {});
        data.needs = Object.fromEntries(Object.entries(this.needs).map(([k,v])=>[k,v.value]));
        data.savings = this.savings;
        data.wants   = this.wants;
        localStorage.setItem('elev8r_user', JSON.stringify(data));
        alert('Saved!');
      }
    }
  }
  </script>
</body>
</html>